(()=>{"use strict";var e="",t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;return crypto.getRandomValues(new Uint8Array(e)).reduce((function(e,t){return e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")}),"")},n={name:".profile__name",info:".profile__work",avatar:".profile__image"},r={formSelector:".popup__form",inputSelector:".popup__item",submitBtnSelector:".popup__btn_action_submit",submitErrorSelector:".popup__error_submit",inputErrorClass:"popup__item_type_error",errorVisibleClass:"popup__error_visible"},o=".popup_content_card",i=".popup_content_profile",a=".popup_content_avatar",c=".popup_content_confirm",s={buttonClose:".popup__btn_action_close",openedClass:"popup_opened",noScrollClass:"page_no-scroll"},l={form:r.formSelector,input:r.inputSelector},u={errorSelector:r.submitErrorSelector,visibleClass:r.errorVisibleClass};const f=[{title:"Петергоф",link:e+"947a53795d8bd6bce399.jpg",likes:[],owner:0,id:1},{title:"Петергоф",link:e+"d5249dfbe08df7ca2456.jpg",likes:[],owner:0,id:2},{title:"Петергоф",link:e+"57bdf3c491d88d61c73e.jpg",likes:[],owner:0,id:3},{title:"Ораниенбаум",link:e+"48084ea7e7f2848bd863.jpg",likes:[],owner:0,id:4},{title:"Парк Александрия",link:e+"504811f3f27842af5297.jpg",likes:[],owner:0,id:5},{title:"Петергоф",link:e+"8dd60d68d5fabf0926ac.jpg",likes:[],owner:0,id:6}];var p="Ошибка",h="Сохранить",y="Сохранение...";function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}const _=new(function(){function e(t){var n=t.baseUrl,r=t.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=n,this._headers=r}var t,n;return t=e,(n=[{key:"_handleResponse",value:function(e){return e.ok?e.json():Promise.reject(e.status)}},{key:"getUserInfo",value:function(){var e=this;return fetch("".concat(this._baseUrl,"/profile"),{method:"GET",headers:this._headers}).then((function(t){return e._handleResponse(t)}))}},{key:"getInitialCards",value:function(){var e=this;return fetch("".concat(this._baseUrl,"/cards"),{method:"GET",headers:this._headers}).then((function(t){return e._handleResponse(t)}))}},{key:"postNewCard",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then((function(e){return t._handleResponse(e)}))}},{key:"patchNewAvatar",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/profile"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then((function(e){return t._handleResponse(e)}))}},{key:"patchUserProfile",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/profile"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.info})}).then((function(e){return t._handleResponse(e)}))}},{key:"likeCard",value:function(e,t){var n=this;return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"PATCH",headers:this._headers,body:JSON.stringify({likes:t})}).then((function(e){return n._handleResponse(e)}))}},{key:"unlikeCard",value:function(e,t){var n=this;return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"PATCH",headers:this._headers,body:JSON.stringify({likes:t})}).then((function(e){return n._handleResponse(e)}))}},{key:"deleteCard",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return t._handleResponse(e)}))}}])&&d(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}())({baseUrl:"https://my-json-server.typicode.com/kateworks/data",headers:{"Content-Type":"application/json"}});function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}const b=new(function(){function e(t){var n=t.name,r=t.info,o=t.avatar;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=document.querySelector(n),this._info=document.querySelector(r),this._avatar=document.querySelector(o),this._userId=0}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._name.textContent,info:this._info.textContent}}},{key:"getUserID",value:function(){return this._userId}},{key:"getUserAvatar",value:function(){return this._avatar.src}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.info;this._name.textContent=t,this._info.textContent=n}},{key:"setUserAvatar",value:function(e){this._avatar.src=e}},{key:"setUserId",value:function(e){this._userId=e}}])&&v(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}())(n);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const g=function(e){var t,n=b.getUserID(),r=e.getCardId(),o=e.isLiked(),i=e.getLikes(),a=o?"удалить":"поставить",c=o?function(e,t){return _.unlikeCard(e,t)}:function(e,t){return _.likeCard(e,t)},s=o?i.filter((function(e){return e!==n})):[].concat(function(e){if(Array.isArray(e))return m(e)}(t=i)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[n]);c(r,s).then((function(t){e.setLikes(t.likes)})).catch((function(t){console.log("Невозможно ".concat(a," лайк. Ошибка ").concat(t,".")),e.setLikes(s)})).finally((function(){e.setLikeGroup(n)}))};function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._form=n,this._submit=n.querySelector(t.submitBtnSelector),this._inputList=Array.from(n.querySelectorAll(t.inputSelector)),this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorVisibleClass}var t,n;return t=e,(n=[{key:"_showInputError",value:function(e,t){var n=this._form.querySelector("#".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),n.textContent=t,n.classList.add(this._errorClass)}},{key:"_hideInputError",value:function(e){var t=this._form.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"_toggleSubmitState",value:function(){this._submit.disabled=this._hasInvalidInput()}},{key:"_setEventListeners",value:function(){var e=this;this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleSubmitState()}))}))}},{key:"setInitialState",value:function(){var e=this;this._inputList.forEach((function(t){e._hideInputError(t),e._toggleSubmitState()}))}},{key:"enableValidation",value:function(){this._setEventListeners()}}])&&k(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=function(){function e(t,n){var r=n.buttonClose,o=n.openedClass,i=n.noScrollClass;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=document.querySelector(t),this._closeButton=this._popup.querySelector(r),this._openedClass=o,this._noScrollClass=i,this._handleEscClose=this._handleEscClose.bind(this)}var t,n;return t=e,(n=[{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"_handleOverlayClose",value:function(e){e.target===e.currentTarget&&this.close()}},{key:"setEventListeners",value:function(){var e=this;this._popup.addEventListener("click",(function(t){e._handleOverlayClose(t)})),this._closeButton.addEventListener("click",(function(){e.close()}))}},{key:"open",value:function(){this._popup.classList.add(this._openedClass),document.addEventListener("keydown",this._handleEscClose),document.body.classList.add(this._noScrollClass)}},{key:"close",value:function(){this._popup.classList.contains(this._openedClass)&&(this._popup.classList.remove(this._openedClass),document.removeEventListener("keydown",this._handleEscClose),document.body.classList.remove(this._noScrollClass))}}])&&S(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(){return j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=L(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},j.apply(this,arguments)}function L(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=R(e)););return e}function P(e,t){return P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},P(e,t)}function I(e,t){if(t&&("object"===E(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}var U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=R(r);if(o){var n=R(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return I(this,e)});function a(e,t,n){var r,o=n.errorSelector,c=n.visibleClass;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=i.call(this,e,t))._popupErrorMessage=r._popup.querySelector(o),r._errorVisibleClass=c,r}return t=a,(n=[{key:"hideErrorMessage",value:function(){var e=this._errorVisibleClass;this._popupErrorMessage.classList.contains(e)&&(this._popupErrorMessage.classList.remove(e),this._popupErrorMessage.textContent="-")}},{key:"close",value:function(){this.hideErrorMessage(),j(R(a.prototype),"close",this).call(this)}}])&&O(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(C);function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(){return x="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=A(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},x.apply(this,arguments)}function A(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=V(e)););return e}function B(e,t){return B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},B(e,t)}function D(e,t){if(t&&("object"===q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function V(e){return V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},V(e)}var M=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=V(r);if(o){var n=V(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return D(this,e)});function a(e,t,n,r,o){var c,s=r.form,l=r.input;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(c=i.call(this,e,t,n))._form=c._popup.querySelector(s),c._inputList=Array.from(c._form.querySelectorAll(l)),c._submitHandler=o,c}return t=a,n=[{key:"_emptyInputs",value:function(){this._inputList.forEach((function(e){e.value=""}))}},{key:"_getInputValues",value:function(){var e={};return this._inputList.forEach((function(t){e[t.name]=t.value})),e}},{key:"setEventListeners",value:function(){var e=this;x(V(a.prototype),"setEventListeners",this).call(this),this._popup.addEventListener("submit",(function(t){t.preventDefault(),e._submitHandler(e._getInputValues())})),this._inputList.forEach((function(t){t.addEventListener("click",(function(){x(V(a.prototype),"hideErrorMessage",e).call(e)}))}))}},{key:"open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._inputList.forEach((function(t){t.value=e[t.name]||""})),x(V(a.prototype),"open",this).call(this)}},{key:"close",value:function(){x(V(a.prototype),"close",this).call(this),this._emptyInputs()}}],n&&T(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(U);function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var H=function(){function e(t,n){var r=n.errorSelector,o=n.visibleClass;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._element=t.querySelector(r),this._message="",this._visibleClass=o}var t,n;return t=e,n=[{key:"_showMessage",value:function(e){this._element.textContent=e,this._element.classList.add(this._visibleClass)}},{key:"_hideMessage",value:function(){this._element.textContent="",this._element.classList.contains(this._visibleClass)&&this._element.classList.remove(this._visibleClass)}},{key:"toggle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e&&e.length>0?this._showMessage(e):this._hideMessage()}}],n&&N(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),G=document.querySelector("".concat(i," ").concat(r.formSelector)),J=new w(r,G),$=new M(i,s,u,l,(function(e){var t,n,o;t=e,n=G.querySelector(r.submitBtnSelector),o=new H(G,u),n.textContent=y,_.patchUserProfile(t).then((function(e){var t=e.name,n=e.about,r=e.id;b.setUserInfo({name:t,info:n}),b.setUserId(r),o.toggle(),$.close()})).catch((function(e){var t="".concat("Невозможно обновить профиль пользователя."," ").concat(p," ").concat(e,".");console.log(t),o.toggle(t)})).finally((function(){n.textContent=h}))})),z=document.querySelector("".concat(a," ").concat(r.formSelector)),F=new w(r,z),K=new M(a,s,u,l,(function(e){!function(e){var t=z.querySelector(r.submitBtnSelector),n=new H(z,u);t.textContent=y,_.patchNewAvatar(e).then((function(e){b.setUserAvatar(e.avatar),b.setUserId(e.id),n.toggle(),K.close()})).catch((function(e){var t="".concat("Невозможно обновить аватар на сервере."," ").concat(p," ").concat(e,".");console.log(t),n.toggle(t)})).finally((function(){t.textContent=h}))}(e)}));function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function X(){return X="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Y(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},X.apply(this,arguments)}function Y(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=te(e)););return e}function Z(e,t){return Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Z(e,t)}function ee(e,t){if(t&&("object"===Q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function te(e){return te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},te(e)}var ne=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=te(r);if(o){var n=te(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ee(this,e)});function a(e,t,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(o=i.call(this,e,t,n))._submitHandler=r,o}return t=a,(n=[{key:"setEventListeners",value:function(){var e=this;X(te(a.prototype),"setEventListeners",this).call(this),this._popup.addEventListener("submit",(function(t){t.preventDefault(),e._submitHandler(e._element)}))}},{key:"open",value:function(e){this._element=e,X(te(a.prototype),"open",this).call(this)}}])&&W(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(U))(c,s,u,(function(e){!function(e){var t=document.querySelector("".concat(c," ").concat(r.formSelector)),n=t.querySelector(r.submitBtnSelector),o=new H(t,u);n.textContent="Удаление...",_.deleteCard(e.getCardId()).then((function(){e.delete(),o.toggle(),ne.close()})).catch((function(e){var t="".concat("Невозможно удалить карточку."," ").concat(p," ").concat(e,".");console.log(t),o.toggle(t)})).finally((function(){n.textContent="Да"}))}(e)}));const re=ne;function oe(e){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oe(e)}function ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ae(){return ae="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=ce(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ae.apply(this,arguments)}function ce(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ue(e)););return e}function se(e,t){return se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},se(e,t)}function le(e,t){if(t&&("object"===oe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ue(e){return ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ue(e)}var fe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&se(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ue(r);if(o){var n=ue(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return le(this,e)});function a(e,t,n){var r,o=n.imageSelector,c=n.captionSelector;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=i.call(this,e,t))._image=r._popup.querySelector(o),r._caption=r._popup.querySelector(c),r}return t=a,(n=[{key:"open",value:function(e){var t=e.title,n=e.link;this._image.src=n,this._image.alt=t,this._caption.textContent=t,ae(ue(a.prototype),"open",this).call(this)}}])&&ie(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(C);function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var he=function(){function e(t,n,r){var o=t.data,i=t.handleClick,a=t.handleLike,c=t.handleDelete;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._templateSelector=n,this._className=r,this._title=o.title,this._link=o.link,this._likes=o.likes,this._isLiked=!1,this._owner=o.owner,this._id=o.id,this._handleViewEvent=i,this._handleLikeEvent=a,this._handleDeleteEvent=c}var t,n;return t=e,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.querySelector(this._className).cloneNode(!0)}},{key:"_setEventListeners",value:function(){var e=this,t={title:this._title,link:this._link};this._likeBtn.addEventListener("click",(function(){return e._handleLikeEvent(e)})),this._delBtn.addEventListener("click",(function(){return e._handleDeleteEvent(e)})),this._image.addEventListener("click",(function(){return e._handleViewEvent(t)}))}},{key:"_setLikeButton",value:function(){this._likeBtn.classList.add("card__btn_clicked")}},{key:"_unsetLikeButton",value:function(){this._likeBtn.classList.remove("card__btn_clicked")}},{key:"delete",value:function(){this._element.remove(),this._element=null}},{key:"setLikes",value:function(e){this._likes=e}},{key:"getLikes",value:function(){return this._likes}},{key:"getCardId",value:function(){return this._id}},{key:"isLiked",value:function(){return this._isLiked}},{key:"setLikeGroup",value:function(e){this._isLiked=this._likes.some((function(t){return t===e})),this._numLikes.textContent=String(this._likes.length),this._likes.length?this._setLikeButton():this._unsetLikeButton()}},{key:"createCard",value:function(e){this._element=this._getTemplate(),this._likeBtn=this._element.querySelector(".card__btn_action_like"),this._delBtn=this._element.querySelector(".card__btn_action_del"),this._image=this._element.querySelector(".card__image"),this._numLikes=this._element.querySelector(".card__like-num"),this._setEventListeners(),this._element.querySelector(".card__title").textContent=this._title,this._numLikes.textContent=String(this._likes.length),this.setLikeGroup(e);var t=this._owner===e;return this._delBtn.disabled=!t,this._delBtn.hidden=!t,this._image.src=this._link,this._image.alt=this._title,this._image.title="Для просмотра карточки щелкните по ней",this._element}}])&&pe(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var de=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=r,this._renderer=o,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"addItem",value:function(e){this._container.prepend(e)}},{key:"renderItems",value:function(){var e=this;this._items.forEach((function(t){e._renderer(t)}))}}])&&ye(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function _e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ve=[],be=null,me=new fe(".popup_content_image",s,{imageSelector:".popup__image",captionSelector:".popup__image-caption"}),ge=function(e){var t=new he({data:e,handleClick:function(e){me.open(e)},handleLike:function(e){g(e)},handleDelete:function(e){re.open(e)}},"#card-template",".card").createCard(b.getUserID());be.addItem(t)},ke=document.querySelector(".profile__btn_action_add"),we=document.querySelector("".concat(o," ").concat(r.formSelector)),Se=new w(r,we),Ce=new M(o,s,u,l,(function(e){!function(e){var n=we.querySelector(r.submitBtnSelector),o=new H(we,u);n.textContent=y;var i={id:t(),name:e.title,link:e.link,likes:[],ownerId:0};_.postNewCard(i).then((function(e){var t=e.name,n=e.link,r=e.likes,i=e.ownerId,a=e.id;ge({title:t,link:n,likes:r,owner:i,id:a}),o.toggle(),Ce.close()})).catch((function(e){var t="".concat("Невозможно сохранить карточку на сервере."," ").concat(p," ").concat(e,".");console.log(t),o.toggle(t)})).finally((function(){n.textContent="Создать"}))}(e)}));Ce.setEventListeners(),$.setEventListeners(),me.setEventListeners(),K.setEventListeners(),re.setEventListeners(),Se.enableValidation(),J.enableValidation(),F.enableValidation(),ke.addEventListener("click",(function(){Ce.open(),Se.setInitialState()})),document.querySelector(".profile__btn_action_edit").addEventListener("click",(function(){$.open(b.getUserInfo()),J.setInitialState()})),document.querySelector(n.avatar).addEventListener("click",(function(){var e=b.getUserAvatar();K.open({avatar:e}),F.setInitialState()})),Promise.all([_.getUserInfo(),_.getInitialCards()]).then((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return _e(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_e(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];if(o){var a=o.id,c=o.name,s=o.about,l=o.avatar;console.log("Информация о пользователе получена с сервера."),b.setUserInfo({name:c,info:s}),b.setUserAvatar(l),b.setUserId(a)}else console.log("Невозможно прочитать профиль пользователя.");i?(console.log("Информация о карточках получена с сервера."),ve=i.map((function(e){return{title:e.name,link:e.link,likes:e.likes,owner:e.ownerId,id:e.id}}))):(console.log("Невозможно получить карточки с сервера."),ve=f)})).catch((function(e){console.log("".concat("Невозможно прочитать данные с сервера."," ").concat(e,".")),ve=f})).finally((function(){(be=new de({items:ve,renderer:function(e){return ge(e)}},".photo-grid__list")).renderItems()}))})();